<!doctype html><meta charset=utf-8>
<meta name=viewport content="width=device-width, height=device-height, initial-scale=1" id=$viewport>

<script>
	if (CSS.supports('-webkit-touch-callout', 'none')) // iOS safari
		document.querySelector('meta[name=viewport]').content += ", user-scalable=no"
</script>

<script src=textarea.js></script>

<link rel=stylesheet href=res/fonts.css>
<link rel=preload as=style href=res/sort.css>

<style>
	.post {
		border: solid;
	}
	pre {
		white-space: pre-wrap;
		word-break: break-word;
	}
</style>

<body>

<textarea-container class='limit'>
	<textarea id=$in></textarea>
</textarea-container>
<hr>
<button id=$go>render</button>
<label>auto:<input type=checkbox checked id=$auto></label>
<time id=$time></time>
<hr>
<div class='post' id=$host></div>
<pre id=$out2></pre>

<script type=module>
	import process from './main.js'
	
	let style = document.createElement('link')
	style.rel = 'stylesheet'
	style.href = 'res/sort.css'
	
	let prose = document.createElement('div')
	prose.className = 'prose'
	
	let sh = $host.attachShadow({mode:'open'})
	sh.append(style, prose)
	
	window.run = ()=>{
		let p = performance.now()
		let out = process($in.value)
		prose.replaceChildren(out)
		let t = performance.now()-p
		$time.textContent = t.toFixed(1)+" ms"
		$out2.textContent = prose.innerHTML.replace(/\n/g, 'â¤¶\n')
	}
	
	setup_textarea($in, ()=>{
		if ($auto.checked && window.run)
			run()
	})
	
	$go.onclick = run
	run()
</script>
