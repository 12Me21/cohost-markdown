<!doctype html><meta charset=utf-8>
<meta name=viewport content="width=device-width, height=device-height, initial-scale=1" id=$viewport>

<script>
	if (CSS.supports('-webkit-touch-callout', 'none')) // iOS safari
		document.querySelector('meta[name=viewport]').content += ", user-scalable=no"
</script>

<script src=textarea.js></script>

<link rel=stylesheet href=prose.css disabled id=$style>

<script src=./_build.js></script>

<style>
	textarea {
		box-sizing: border-box;
		width: 100%;
		resize: vertical;
	}
	.post {
		border: solid;
	}
	#\$out2 {
		white-space: pre-wrap;
		word-break: break-word;
	}
</style>

<body>

<textarea-container class='limit'>
	<textarea id=$in></textarea>
</textarea-container>
<hr>
<button id=$go>render</button>
<label>auto:<input type=checkbox checked id=$auto></label>
<div id=$time></div>
<hr>
<div class='post' id=$host></div>
<div id=$out class='prose'></div>
<div id=$out2><br></div>

<script type=module>
	customElements.define('te-st', class extends HTMLElement {
		constructor() {
			super()
			console.log('ee')
		}
	})
	
	import process from './main.js'
	
	window.run = ()=>{
		let p = performance.now()
		let out = process($in.value)
		$out.replaceChildren(out)
		let t = performance.now()-p
		$time.textContent = t
		//$out = out
	}
	
	window.$out = $out
	let sh = $host.attachShadow({mode:'open'})
	let st = $style.cloneNode(true)
	st.disabled = false
	sh.append(st, $out)
	
	setup_textarea($in, ()=>{
		if ($auto.checked && window.run)
			run()
	})
	
	$go.onclick = run
	run()
</script>
